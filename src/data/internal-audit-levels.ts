// ═══════════════════════════════════════════════════
// بيانات المستويات الثلاثة للمراجعة الداخلية
// ═══════════════════════════════════════════════════

export interface AuditLevelModule {
  title: string;
  description?: string;
  topics: string[];
  duration?: string;
  lessons?: number;
}

export interface AuditLevel {
  id: 1 | 2 | 3;
  title: string;
  description: string;
  modules: AuditLevelModule[];
}

export const auditLevels: AuditLevel[] = [
  {
    id: 1,
    title: 'المستوى الأول - التأسيس',
    description: 'أساسيات المراجعة الداخلية والمفاهيم الأولية',
    modules: [
      {
        title: 'المحور 1: تأسيس إدارة المراجعة الداخلية',
        description: 'تأسيس إدارة المراجعة الداخلية',
        topics: [
          'المفهوم والدور الاستراتيجي للمراجعة الداخلية',
          'المعايير والكفاءات وتدقيق المنهجية',
          'أخلاقيات المهنة',
          'أدلة إدارة المراجعة الداخلية',
          'ميثاق المراجعة الداخلية',
          'هيكل الإدارة والصلاحيات والمسؤوليات'
        ],
      },
      {
        title: 'المحور 2: إعداد خطة المراجعة السنوية',
        description: 'إعداد خطة المراجعة السنوية',
        topics: [
          'مفهوم المراجعة المبنية على المخاطر',
          'خطوات إعداد الخطة السنوية خطوة بخطوة',
          'مصفوفة المخاطر',
          'تحديث الخطة ومراجعتها خلال العام'
        ],
      },
      {
        title: 'المحور 3: إعداد برنامج المراجعة',
        description: 'إعداد برنامج المراجعة',
        topics: [
          'خطوات برنامج المهمة',
          'ملف أوراق العمل',
          'تحويل خطة المراجعة إلى برامج تنفيذية',
          'تحديد نطاق العمل',
          'توثيق البرنامج واعتماده'
        ],
      },
      {
        title: 'المحور 4: تنفيذ إجراءات المراجعة',
        description: 'تنفيذ إجراءات المراجعة',
        topics: [
          'خطوات جمع الأدلة',
          'أدوات وأساليب المراجعة',
          'التحقق من الضوابط الداخلية',
          'توثيق النتائج في أوراق العمل'
        ],
      },
      {
        title: 'المحور 5: تحليل النتائج وتقييم المخاطر',
        description: 'تحليل النتائج وتقييم المخاطر',
        topics: [
          'التمييز بين الملاحظة والنتيجة والاستنتاج',
          'تقييم فعالية الرقابة الداخلية',
          'الربط بين النتائج والأهداف الاستراتيجية',
          'إعداد ملخص النتائج لمناقشة أولية مع الإدارة'
        ],
      },
      {
        title: 'المحور 6: إعداد التقارير',
        description: 'إعداد التقارير',
        topics: [
          'مكونات تقرير المراجعة',
          'أسلوب صياغة الملاحظات بوضوح واحترافية',
          'تقارير تفصيلية مقابل تقارير مختصرة',
          'ضمان الموضوعية والحيادية في التقرير'
        ],
      },
      {
        title: 'المحور 7: متابعة تنفيذ التوصيات',
        description: 'متابعة تنفيذ التوصيات',
        topics: [
          'آلية وضع خطة عمل لتنفيذ التوصيات',
          'تحديد المسؤوليات والجدول الزمني',
          'المتابعة الدورية',
          'رفع تقارير متابعة إلى الإدارة العليا'
        ],
      },
      {
        title: 'المحور 8: مهارات اجتياز المقابلات الشخصية',
        description: 'مهارات اجتياز المقابلات الشخصية',
        topics: [
          'مهارات اجتياز المقابلات الشخصية'
        ],
      }
    ]
  },
  {
    id: 2,
    title: 'المستوى الثاني - الريادة في المراجعة الداخلية',
    description: 'التطبيق العملي والأدوات المتقدمة',
    modules: [
      {
        title: 'المحور 1: إطار COSO لتقييم الرقابة الداخلية',
        description: 'إطار COSO لتقييم الرقابة الداخلية',
        topics: [
          'إطار عالمي ومرجع أساسي لتصميم وتقييم أنظمة الرقابة الداخلية',
          'ضمان تحقيق الأهداف',
          'حماية الأصول',
          'دقة التقارير',
          'الالتزام بالقوانين واللوائح'
        ],
      },
      {
        title: 'المحور 2: التقييم المستمر وتحسين الأداء',
        description: 'التقييم المستمر وتحسين الأداء',
        topics: [
          'أهمية مراقبة جودة المراجعة الداخلية',
          'أدوات التقييم الذاتي',
          'المراجعة الخارجية للجودة',
          'تحديد فجوات الأداء',
          'وضع خطة تطوير الكفاءات'
        ],
      },
      {
        title: 'المحور 3: مراجعة نظم وأمن المعلومات (IT Audit)',
        description: 'مراجعة نظم وأمن المعلومات (IT Audit)',
        topics: [
          'تقييم ضوابط الوصول والصلاحيات',
          'مراجعة التطبيقات والأنظمة',
          'تحليل البيانات باستخدام أدوات متقدمة (ACL, IDEA, Power BI)',
          'ضوابط الحوكمة الرقمية وامتثال الأنظمة'
        ],
      },
      {
        title: 'المحور 4: منهجية COBIT',
        description: 'منهجية COBIT',
        topics: [
          'أهميتها في حوكمة تكنولوجيا المعلومات وربطها بأهداف المنظمة',
          'العلاقة بين COBIT وإطار COSO للرقابة الداخلية'
        ],
      },
      {
        title: 'المحور 5: الاحتيال',
        description: 'الاحتيال',
        topics: [
          'التعرف على أنواع الاحتيال (المالي، التشغيلي، الإلكتروني)',
          'تحليل المخاطر الاحتيالية على مستوى المنظمة بأكملها',
          'تقييم ضوابط الوقاية والمكافحة',
          'تطوير سياسات ضوابط داخلية قوية في جميع الإدارات',
          'الإبلاغ والتحقيق في الاحتيال',
          'كيفية إعداد تقارير التحقيقات الداخلية لإلدارة العليا ومجلس الإدارة'
        ],
      },
      {
        title: 'المحور 6: الحوكمة - المخاطر - الامتثال',
        description: 'الحوكمة - المخاطر - الامتثال',
        topics: [
          'تصميم وتنفيذ برامج حوكمة متكاملة',
          'دمج الحوكمة مع إدارة المخاطر والرقابة الداخلية',
          'الحوكمة الرقمية والامتثال للقوانين الدولية والمحلية وضوابط الشركات'
        ],
      },
      {
        title: 'المحور 7: حالات عملية متقدمة',
        description: 'حالات عملية متقدمة',
        topics: [
          'حالات ومواقف حقيقية من بيئات مختلفة (صناعة، مالية، تعليم، صحة)',
          'تدريب جماعي على تحليل الموقف وتقديم الحلول',
          'محاكاة جلسات مراجعة أمام لجنة تدقيق أو مجلس إدارة'
        ],
      },
      {
        title: 'المحور 8: الدليل العملي للنماذج التشغيلية والرقابية',
        description: 'الدليل العملي للنماذج التشغيلية والرقابية',
        topics: [
          'يتضمن أدلة وسياسات وإجراءات',
          'نماذج الإدارات',
          'مصفوفات الصلاحيات',
          'مؤشرات الأداء',
          'خطط المراجعة',
          'التقييمات'
        ],
      }
    ]
  },
  {
    id: 3,
    title: 'المستوى الثالث - تطوير الكفاءات المتكاملة للمراجع الداخلي',
    description: 'المعايير الدولية والقيادة الإستراتيجية',
    modules: [
      {
        title: 'المحور 1: المهارات المالية لغير الماليين',
        description: 'المهارات المالية لغير الماليين',
        topics: [
          'فهم القوائم المالية الأساسية (قائمة الدخل، الميزانية، التدفقات النقدية)',
          'التعرف على مؤشرات الأداء المالي الرئيسية',
          'التحليل المالي المبسط لتقييم الأداء وربط النتائج المالية بالمخاطر التشغيلية'
        ],
      },
      {
        title: 'المحور 2: مهارات الحاسب الآلي واللغة الإنجليزية للمراجع الداخلي',
        description: 'مهارات الحاسب الآلي واللغة الإنجليزية للمراجع الداخلي',
        topics: [
          'مهارات اللغة الإنجليزية المهنية والمصطلحات المالية والإدارية والمحاسبية الأساسية',
          'PowerPoint: إعداد عروض احترافية للمراجعة الداخلية والإدارة العليا',
          'استخدام Excel و Power BI لتحليل بيانات ومؤشرات الأداء'
        ],
      },
      {
        title: 'المحور 3: مهارات الإقناع والتفاوض وكتابة التقارير',
        description: 'مهارات الإقناع والتفاوض وكتابة التقارير',
        topics: [
          'إتقان فن إقناع الإدارة العليا بجدوى التوصيات المهنية وإبراز قيمتها في دعم الأهداف الاستراتيجية',
          'توظيف البيانات والأدلة التحليلية لصياغة آراء واضحة ومقنعة تعزز من مصداقية المراجع الداخلي',
          'تنمية مهارات التواصل مع مختلف الشخصيات وأنماط القيادات داخل المنظمة',
          'تطوير القدرة على التأثير الإيجابي في عملية اتخاذ القرار مع الحفاظ على التوافق مع السياسات والإجراءات',
          'احتراف التفاوض البنّاء مع الإدارات المختلفة خلال تنفيذ مهام المراجعة',
          'إدارة الاعتراضات والنقاشات باحترافية وهدوء يحافظ على قوة العلاقة المهنية ويحقق الأهداف'
        ],
      }
    ]
  }
];

/**
 * تحويل بيانات المستويات إلى هيكل Modules و Lessons
 * للاستخدام في صفحة الدروس
 */
export interface File {
  id: number;
  title: string;
  type: 'video' | 'pdf' | 'audio';
  size: string;
  duration?: string;
  url?: string;
  videoUrl?: string;
}

export interface Lesson {
  id: number;
  title: string;
  order: number;
  files: File[];
  description?: string;
  objectives?: string[];
  videoUrl?: string;
}

export interface Module {
  id: number;
  title: string;
  order: number;
  lessons: Lesson[];
  isLevel?: boolean; // للتمييز بين المستوى والمحور
  levelId?: number; // معرف المستوى التابع له
}

/**
 * تحويل بيانات المستويات إلى هيكل Modules و Lessons
 * الهيكل: المستوى (Module رئيسي) -> المحور (Module فرعي) -> المحور الفرعي (Lessons)
 */
export function convertAuditLevelsToModules(): Module[] {
  const modules: Module[] = [];
  let globalModuleId = 1;
  let globalLessonId = 1;

  auditLevels.forEach((level) => {
    // إضافة المستوى كـ Module رئيسي (بدون lessons مباشرة)
    const levelModule: Module = {
      id: globalModuleId++,
      title: level.title,
      order: level.id,
      lessons: [], // المستوى لا يحتوي على lessons مباشرة
      isLevel: true,
      levelId: level.id,
    };
    modules.push(levelModule);

    // إضافة المحاور كـ Modules فرعية داخل المستوى
    level.modules.forEach((module, moduleIndex) => {
      // تحويل topics إلى Lessons (المحاور الفرعية)
      const moduleLessons: Lesson[] = module.topics.map((topic, topicIndex) => ({
        id: globalLessonId++,
        title: topic,
        order: topicIndex + 1,
        files: [],
        description: module.description,
      }));

      // إضافة المحور كـ Module فرعي
      const moduleData: Module = {
        id: globalModuleId++,
        title: module.title,
        order: moduleIndex + 1,
        lessons: moduleLessons, // المحور يحتوي على Lessons (المحاور الفرعية)
        isLevel: false,
        levelId: level.id,
      };

      modules.push(moduleData);
    });
  });

  return modules;
}

/**
 * الحصول على بيانات المستوى حسب المعرف
 */
export function getLevelById(levelId: 1 | 2 | 3): AuditLevel | undefined {
  return auditLevels.find(level => level.id === levelId);
}

/**
 * الحصول على جميع المحاور لمستوى معين
 */
export function getModulesByLevelId(levelId: 1 | 2 | 3): AuditLevelModule[] {
  const level = getLevelById(levelId);
  return level?.modules || [];
}

